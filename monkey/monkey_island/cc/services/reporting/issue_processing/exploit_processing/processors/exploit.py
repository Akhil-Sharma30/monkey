from __future__ import annotations

from dataclasses import dataclass

from monkey_island.cc.services.node import NodeService


@dataclass
class ExploiterReportInfo:
    machine: str
    ip_address: str
    type: str


class ExploitProcessor:

    @staticmethod
    def get_exploit_info_by_dict(class_name: str, exploit_dict: dict) -> ExploiterReportInfo:
        ip_addr = exploit_dict['data']['machine']['ip_addr']
        machine = NodeService.get_node_hostname(NodeService.get_node_or_monkey_by_ip(ip_addr))
        return ExploiterReportInfo(ip_address=ip_addr, machine=machine, type=class_name)
