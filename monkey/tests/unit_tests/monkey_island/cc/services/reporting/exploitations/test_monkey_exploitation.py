from tests.unit_tests.monkey_island.cc.services.reporting.test_report import (
    NODE_DICT,
    NODE_DICT_DUPLICATE_EXPLOITS,
    NODE_DICT_FAILED_EXPLOITS,
)

from monkey_island.cc.services.reporting.exploitations.monkey_exploitation import (
    get_exploits_used_on_node,
)


def test_get_exploits_used_on_node__2_exploits():
    exploits = get_exploits_used_on_node(NODE_DICT)
    assert sorted(exploits) == sorted(["Elastic Groovy Exploiter", "Drupal Server Exploiter"])


def test_get_exploits_used_on_node__duplicate_exploits():
    exploits = get_exploits_used_on_node(NODE_DICT_DUPLICATE_EXPLOITS)
    assert exploits == ["Drupal Server Exploiter"]


def test_get_exploits_used_on_node__failed():
    exploits = get_exploits_used_on_node(NODE_DICT_FAILED_EXPLOITS)
    assert exploits == []
