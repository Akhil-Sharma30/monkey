# from infection_monkey.exploit.powershell_utils.auth_options import AuthOptions
from infection_monkey.exploit.powershell_utils.auth_options_generators import get_auth_options
from infection_monkey.exploit.powershell_utils.credentials import Credentials

CREDENTIALS = [
    Credentials("user1", "password1"),
    Credentials("user2", ""),
    Credentials("user3", None),
]


def test_get_auth_options__ssl_true_with_password():
    auth_options = get_auth_options(CREDENTIALS, ssl=True)

    assert auth_options[0].ssl


def test_get_auth_options__ssl_true_empty_password():
    auth_options = get_auth_options(CREDENTIALS, ssl=True)

    assert not auth_options[1].ssl


def test_get_auth_options__ssl_true_none_password():
    auth_options = get_auth_options(CREDENTIALS, ssl=True)

    assert auth_options[2].ssl


def test_get_auth_options__ssl_false_with_password():
    auth_options = get_auth_options(CREDENTIALS, ssl=False)

    assert not auth_options[0].ssl


def test_get_auth_options__ssl_false_empty_password():
    auth_options = get_auth_options(CREDENTIALS, ssl=False)

    assert not auth_options[1].ssl


def test_get_auth_options__ssl_false_none_password():
    auth_options = get_auth_options(CREDENTIALS, ssl=False)

    assert not auth_options[2].ssl
