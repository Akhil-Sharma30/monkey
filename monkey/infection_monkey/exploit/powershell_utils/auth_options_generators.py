from typing import List

from infection_monkey.exploit.powershell_utils.auth_options import AuthOptions
from infection_monkey.exploit.powershell_utils.credentials import Credentials


def get_auth_options(credentials: List[Credentials], ssl: bool) -> List[AuthOptions]:
    auth_options = []

    for cred in credentials:
        opts = AuthOptions(ssl)

        # Passwordless login only works with SSL false
        if cred.password == "":
            opts.ssl = False

        auth_options.append(opts)

    return auth_options
