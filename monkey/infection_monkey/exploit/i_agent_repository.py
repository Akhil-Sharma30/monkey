import abc
import io

from common import OperatingSystems

# TODO: The Island also has an IAgentRepository with a totally different interface. At the moment,
#       the Island and Agent have different needs, but at some point we should unify these.


class IAgentRepository(metaclass=abc.ABCMeta):
    """
    IAgentRepository provides an interface for other components to access agent binaries. Notably,
    this is used by exploiters during propagation to retrieve the appropriate agent binary so that
    it can be uploaded to a victim and executed.
    """

    @abc.abstractmethod
    def get_agent_binary(
        self, operating_system: OperatingSystems, architecture: str = None
    ) -> io.BytesIO:
        """
        Retrieve the appropriate agent binary from the repository.
        :param operating_system: The name of the operating system on which the agent binary will run
        :param architecture: Reserved
        :return: A file-like object for the requested agent binary
        """
        pass
